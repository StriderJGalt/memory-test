{% extends "layout.html" %}
{% block content %}
<div class="container main">
	<br/>
	<br/>
	<form action="#" method="post" enctype="multipart/form-data">
		<div class="col-md-4 mb-3">
			<label for="state">Type:</label>
			<select name="type" class="custom-select d-block w-100" id="type" onchange="typeChange()" required>
				<option value="url">URL</option>
				<option value="file">Local File</option>
				<option value="upload">Upload</option>
			</select>
			<div class="invalid-feedback">
				Please provide a valid option.
			</div>

		<div class="input-group mb-3 mt-2" id="urlinput">
			<input name="url" type="text" class="form-control" id="urlField" placeholder="Enter URL or local file path" aria-label="Enter URL" aria-describedby="basic-addon2">
		</div>

		<div class="input-group m-4" id="fileinput" style="display:none">
				<input name="file" type="file" class="form-control-file" id="exampleFormControlFile1">
		</div>
			<div class="input-group-append mb-4">
				<button class="btn btn-primary" value="submit" type="submit">Go!</button>
			</div>
		</div>
	</form>

	<div class="jumbotron">
		<h1 class="display-3">Output</h1>
		<div id="audio">

		</div>
		<div >
			Time: 
			<span id="time">

			</span>
		</div>
		<hr class="my-4">
		<div id="data">nothing received yet</div>
	</div>
	<script src="http://code.jquery.com/jquery-latest.js"></script>
	<script charset="utf-8">
		function getResp()
{
	url = document.getElementById('urlField').value
	reqURL = "/api?url=" + url
	window.location.href = reqURL;
}

var url = new URL(document.URL);
url = url.searchParams.get("url");
ele = "<video controls src="+ url +"> Your browser does not support the <code>audio</code> element.  </video>";
console.log(ele)
if(url != "")
{
	document.getElementById('audio').innerHTML = "<audio controls src="+ url +"> Your browser does not support the <code>audio</code> element.  </audio>";
}

function typeChange() {
var v = document.getElementById('type').value;
if ( v=="upload")
{
document.getElementById('urlinput').style.display = "none";
document.getElementById('fileinput').style.display = "";
}
else {
document.getElementById('urlinput').style.display = "";
document.getElementById('fileinput').style.display = "none";

}
}
	</script>
	{% for x in data: %}
	<script>
		document.getElementById("data").innerHTML = "{{x}}"
	</script>
	{% endfor %}
</div>
{% endblock content%}
